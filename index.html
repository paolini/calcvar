<!DOCTYPE html>
<html lang="it">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">        
        <title>Appunti di Calcolo delle Variazioni</title>

        <link rel="stylesheet" type="text/css" href="index.css">

        <!-- Load Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

        <!-- Load KaTeX -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
        <!-- The loading of KaTeX is deferred to speed up page rendering -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js" integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>    
        <!-- To automatically render math in text elements, include the auto-render extension: -->
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
            onload="myRender()"></script>
    </head>
    <body>
        <div class="container"><main>

<h1>Elementi di Calcolo delle Variazioni</h1>
<p>
Il calcolo delle variazioni nasce con il seguente.
</p>
<p class="problem" name="della brachistocrona" label="pb:brachistocrona">
Tra tutte le curve che congiungono due estremi $O$ e $P$ 
in un piano verticale, determinare quella che minimizza 
il tempo di percorrenza di un corpo vincolato sulla curva,
lasciato con velocità nulla nel punto $O$ e soggetto 
alla forza di gravità.
</p>
<p>
Mettiamo degli assi cartesiani ortogonali centrati nel punto $O$
con l'asse delle $x$ orientato verso il basso e l'asse delle $y$ 
orizzontale. 
Siano $(b,c)$ le coordinate del punto $P$.
Supponiamo che la curva si possa scrivere nella forma 
$y=u(x)$. 
Avremo dunque le condizioni: $u(0)=0$ e $u(b) = c$.
Per la conservazione dell'energia abbiamo $\frac 1 2 m v^2 = m g x$
da cui $|v| = \sqrt{2g x}$.
Ma $v(t) = (x'(t),y'(t)) = (x'(t), u'(x(t))x'(t))$ 
da cui 
$$
  |v| = \sqrt{1+u'^2} \cdot |x'|.
$$
Supponiamo ora che sia $x'\ge 0$ (come ci aspettiamo succeda almeno per un certo tratto)
e troviamo dunque $\sqrt{2gx} = \sqrt{1+u'^2} \cdot \frac{dx}{dt}$. 

Avremo allora che il tempo impiegato per andare dal 
punto $0$ lungo la curva fino al punto $P=(b,c)$, è dato da
$$
    T = \int_0^T\, dt = \int_0^a \frac{dt}{dx}\, dx
      = \int_0^b \frac{\sqrt{1+(u'(x))^2}}{\sqrt{2gx}}\, dx.
$$
</p>
<p>
La nostra incognita è la funzione $u$, che supponiamo essere 
di classe $C^1$ per dare senso ai calcoli fatti sopra, e dovrà 
soddisfare le condizioni <i>al bordo</i>
$u(0)=0$ e $u(b)=c$. 
Siamo quindi interessati a cercare la soluzione $u\in U$ 
nell'insieme delle funzioni:
$$
    U = \ENCLOSE{u\in C^1([a,b])\colon u(a)=u_a, u(b)=u_b}
$$
con $a=0$, $u_a=0$, $u_b=c$.
Si noti che $U$ è un sottospazio affine dello spazio 
vettoriale $C^1([a,b])$ infatti si ha 
$$
    U-U 
    = \ENCLOSE{u_1-u_2\colon u_1\in U, u_2\in U}
    = \ENCLOSE{u\in C^1([0,b])\colon u(a)=u(b)=0}
    = C^1_0([a,b]) 
$$
che è un sottospazio vettoriale di $C^1$.
</p>

<p>
Il nostro problema è quindi quello di trovare un 
minimo del funzionale 
$$
\begin{gathered}
    \L \colon U \to \mathbb R,\\
    \L(u) = \int_a^b L(x, u(x), u'(x)) \, dx
\end{gathered}
$$
con $a=0$ e $L(x,y,z)=\frac{\sqrt{1+z^2}}{\sqrt{2gx}}$.
Un funzionale scritto in questa forma è chiamato 
<i>funzionale classico del calcolo delle variazioni.</i>
La funzione $L=L(x,y,z)$ è chiamata <i>lagrangiana</i>.
</p>

<h2>Equazione di Eulero-Lagrange</h2>

<p>
Se $U$ è uno spazio affine parallelo allo spazio vettoriale $V$
data $\phi\in V$ la restrizione del funzionale $\L$ 
alla retta passante per $u$ con direzione $\phi$ 
è data da
$$
    g(t) = \L(u+t\phi).
$$ 
Se $u$ è un punto di minimo del funzionale $\L$ 
allora $0$ dovrà essere punto di minimo per $g$ 
e se $g$ è derivabile si avrà quindi $g'(0)=0$.
</p>
<p>
La derivata $g'(0)$ non è altro che la derivata direzionale 
$\frac{\partial L}{\partial \phi}(u)$
(chiamata <i>derivata di Gateaux,</i>
nel contesto degli spazi di dimensione infinita).
La funzione $\phi$ rappresenta una <i>variazione</i>
della nostra funzione $u$.
In opportune ipotesi la condizione $g'(0)=0$ si
traduce in una equazione differenziale, come enunciato 
nel seguente.
</p>

<p class="theorem" name="equazione di Eulero-Lagrange">
Sia $u\in C^2([a,b])$ e sia $L=L(x,y,z)$ una funzione di 
classe $C^2$ definita in un intorno della curva 
$x\mapsto (x,u(x),u'(x))$. 
Se $\L(u)$ è minimo allora in $u$ si ha
$$
    L_y = \frac{d}{dx} L_z
$$ 
cioè, più esplicitamente,
$$
    L_y (x,u(x),u'(x)) = \frac{d}{dx} \Enclose{L_z(x,u(x),u'(x))}.
$$
</p>
<p class="proof">
Si ha
$$
    \frac{\partial L}{\partial \phi}(u)  
    = \Enclose{\frac{d}{dt}\int_a^b L(x,u+t \phi,u'+t\phi')\, dx}_{t=0}
    = \Enclose{\frac{d}{dt}\int_a^b f(x,t)}_{t=0}
$$
con $g(x,t)= L(x,u(x)+t\phi(x),u'(x)+t\phi'(x))$.
Se $L$ è di classe $C^1$ in un intorno della curva
$x\mapsto (x,u(x),u'(x))$ e se $u$ e $\phi$
sono di classe $C^2$
allora $g(x,y)$ è di classe $C^1$ e 
posso scambiare la derivata con l'integrale:
$$
\Enclose{\frac{d}{dt} \int_a^b L(x,u+t\phi,u'+t\phi')}_{t=0}
= \int_a^b \left[ L_y(x,u,u') \phi 
    + L_z(x,u,u') \phi' \right] \, dx.
$$
Se ora $L$ e $u$ sono di classe $C^2$, 
possiamo integrare per parti e ottenere 
$$
= \int_a^b \enclose{L_y(x,u,u') -(L_z(x,u,u'))_x } \phi(x) \, dx.
$$
In base al lemma seguente concludiamo che 
$$
    L_y = \frac{d}{dx} L_z.
$$
</p>

<p class="lemma" name="fondamentale del calcolo delle variazioni">
Se $g\in C^0([a,b])$ e $\int_a^b g(x)\phi(x)\, dx = 0$ per ogni $\phi\in C_c^\infty([a,b])$
allora $g(x)=0$ per ogni $x\in [a,b]$.
</p>
<p class="proof">
Se fosse $g(x_0) &gt; 0$ con $x_0\in (a,b)$ allora esiste 
un intorno $I$ di $x_0$ tale che $g(x) &gt; 0$ per ogni $x\in I$.
Ma è possibile costruire $\phi\in C_c^\infty([a,b])$ 
tale che $\phi(x_0) &gt; 0$, $\phi(x)\ge 0$ per ogni $x\in I$
e $\phi(x) = 0$ per ogni $x\not \in I$.
Chiaramente si avrebbe $\int_a^b g(x)\phi(x)\, dx 
= \int_I g(x)\phi(x)\, dx &gt; 0$, contro l'ipotesi.

Allo stesso modo si procede se $g(x_0) &lt; 0$. 
Se poi $g$ si annulla su tutto $(a,b)$ per continuità si annulla 
anche su $[a,b]$.
</p>

<h2>La brachistocrona è una cicloide</h2>
<p>
Nel caso del 
<span class="ref" label="pb:brachistocrona"></span> 
della brachistocrona abbiamo 
$L(x,y,z) = \frac{\sqrt{1+z^2}}{\sqrt {2gx}}$ e quindi 
$f_y=0$, $f_z = \frac{z}{\sqrt{1+z^2}\sqrt {2gx}}$.
L'equazione di Eulero-Lagrange diventa quindi
$$
    \frac{d}{dx}\frac{u'}{\sqrt{2gx}\cdot \sqrt{1+u'^2}} = 0.
$$
Dunque esiste una costante $c$ per cui 
$$
    \frac{u'}{\sqrt{x}\cdot \sqrt{1+u'^2}} = c.
$$
Elevando al quadrato
$$
    (u')^2 = c^2\cdot (1+u'^2)\cdot x
$$
da cui 
$$
    (u')^2 
    = c^2 \cdot \frac{x}{1-c^2\cdot x}
    = c^2 \cdot \frac{x^2}{x-c^2 x^2}
$$
supponendo $u'&gt;0$ 
$$\begin{aligned}
    u'(x) 
    &= \frac{cx}{\sqrt{x-c^2x^2}}
    = \frac{cx}{\sqrt{\frac 1{4c^2} - \enclose{cx - \frac 1{2c}}^2}} 
    \\
    &= \frac{2c^2 x}{\sqrt{1-(2c^2 x - 1)^2}}.
\end{aligned}$$
Dunque integrando, e ponendo $R=\frac 1 {2c^2}$, si ha  
$$
\begin{aligned}
    u(x) 
    &= \int_0^x \frac{2c^2x-1 +1}{\sqrt{1-(1 - 2c^2 x)^2}}\, dx
    \\
    &= -\sqrt{1-(1-2c^2x)^2} + \frac{1}{2c^2}\arccos(1-2c^2x)
    \\
    &= R\Enclose{\arccos\enclose{1-\frac x R} - \sqrt{1-\enclose{1-\frac x R}^2}}
    \\
    &= R \arccos\frac{R-x}{R} - \sqrt{R^2 - (x-R)^2}.
\end{aligned}
$$
Si può facilmente riconoscere che $u(x)$ è l'equazione di una cicloide 
ovvero che il punto $P(x) = (x,u(x))$ si trova sulla circonferenza 
di raggio $R$ che rotola al di sotto dell'asse $x$.
Infatti se $\theta$ è l'angolo di rotazione di tale circonferenza, 
si avrà 
$$
    \begin{cases}
    x = R - R \cos\theta \\
    y = R\theta - R\sin\theta  
    \end{cases}
$$
da cui si ottiene $\theta = \arccos \frac{R-x}{R}$
e quindi 
$$
    y = R\arccos\frac{R-x}{R} - \sqrt{R^2 - (x-R)^2} = u(x).
$$
</p>
<p>
La soluzione che abbiamo trovato è solamente il primo arco di 
cicloide, dove $u'&gt;0$. 
Il secondo arco (dove il punto materiale risale rallentando) si trova 
scegliendo il segno opposto quando si estrae la radice quadrata.
</p>
<p>
La costante $R$ può essere univocamente determinata dal passaggio 
dal punto $P$ ovvero dalla condizione $u(a) = b$. 
Si nota infatti che al variare di $R$ le curve che abbiamo trovato 
sono tutte tra loro omotetiche. 
Se disegno una qualunque di queste 
curve, ad esempio quella con $R=1$ e considero la semiretta 
uscente da $O$ e passante dal punto $P=(a,b)$, tale semiretta 
incontrerà la curva in un singolo punto, in quanto possiamo 
verificare che tale curva è concava. 
Allora basterà riscalare la curva in modo da ottenere 
(in modo unico) il passaggio dal punto dato.
</p>

<h2>Formulazione debole</h2>

<p class="theorem noproof" name="teorema di derivazione di Lebesgue">
    Sia $\Omega\subset \RR^d$ aperto, $f\in L^1(\Omega)$.
    Allora per quasi ogni $x\in \Omega$ si ha 
    $$
    \lim_{r\to 0} \frac{1}{\abs{B_r}}\int_{B_r(x)} |f(x)-f(y)|\, dy = 0
    $$
    e quindi 
    $$  
        f(x) = \lim_{r\to 0} \frac{1}{\abs{B_r}}\int_{B_r(x)} f(y)\, dy.
    $$
</p>

<p class="theorem" name="lemma fondamentale del calcolo delle variazioni, forma debole">
    Sia $u\in L^1(a,b)$ una funzione tale che per ogni $\phi\in C_c^\infty(a,b)$ si abbia
    $$
    \int_a^b u(x) \phi(x) \, dx = 0.   
    $$  
    Allora $u=0$ quasi ovunque.

    Sia $u\in L^1(a,b)$ una funzione tale che per ogni $\phi\in C_c^\infty(a,b)$ si abbia
    $$
    \int_a^b u(x) \phi'(x) \, dx = 0.
    $$
    Allora esiste $c\in \RR$ tale che $u=c$ quasi ovunque.
</p>

<p>
    Se $u,v\in L^1(a,b)$ diremo che $v$ è la <emph>derivata debole</emph> 
    di $u$ se per ogni $\phi\in C_c^\infty(a,b)$ si ha
    $$
    \int_a^b u(x)\phi'(x)\, dx = -\int_a^b v(x)\phi(x)\, dx.
    $$
</p>

<div class="theorem" name="proprietà della derivata debole">
    <ol>

        <li>
            Se $v_1$ e $v_2$ sono due derivate deboli di $u$ in $L^1(a,b)$,
            allora $v_1=v_2$ in $L^1(a,b)$.
        </li>
    </ol>
</div>

<p class="proof">
    <ol>
        <li>
            Se $v_1$ e $v_2$ sono due derivate deboli di $u$ allora 
            per ogni $\phi\in C_c^\infty(a,b)$ si ha
            $$
            \int_a^b u(x)\phi'(x)\, dx = -\int_a^b v_1(x)\phi(x)\, dx
            = -\int_a^b v_2(x)\phi(x)\, dx.
            $$
            Ma allora si ha 
            $$
            \int_a^b (v_1(x)-v_2(x))\phi(x)\, dx = 0
            $$
            per ogni $\phi\in C_c^\infty(a,b)$ e quindi 
            $v_1-v_2=0$ in $L^1(a,b)$.
        </li>
    </ol>
</p>

<h2>L'esistenza non è garantita</h2>
<p>
Nei paragrafi precedenti abbiamo mostrato che se c'è una soluzione 
di classe $C^2$ del problema della brachistocrona allora tale soluzione 
può essere univocamente identificata in una particolare cicloide.
Significa che se c'è una soluzione di classe $C^2$ allora l'abbiamo 
trovata. 
Ma nulla ci dice che la soluzione esista, e se esiste non possiamo 
immediatamente affermare che sia di classe $C^2$.
Per convincerci di ciò facciamo dei semplici esempi.
</p>    
<p class="problem" label="pb:1">
Minimizzare il funzionale:
$$
\F(u) = \int_{-1}^1 \Enclose{1-u'(x)^2}^2\, dx
$$
tra le funzioni $u\in C^1_0([-1,1],\R)$.
</p>
<p>
La funzione integranda è sempre non negativa e si annulla 
quando $u'(x)=\pm 1$. 
Dunque una funzione con la proprietà $\abs{u'(x)}=1$ sarebbe
senz'altro un minimo assoluto di questo funzionale.
E' facile verificare che nessuna funzione derivabile può soddisfare 
questa condizione e contemporaneamente assumere lo stesso valore 
ai due estremi dell'intervallo. 
La funzione $u(x) = 1-\abs{x}$, viceversa, soddisfa la condizione 
in tutti i punti tranne $x=0$ (dove non è derivabile) e in effetti 
annulla il funzionale se ci accontentiamo che la derivata esista 
quasi ovunque. 
D'altra parte ci sono funzioni $C^1_0$ che approssimano questa funzione 
derivabile e che danno valori arbitrariamente piccoli al funzionale.
</p>
<p>
Dunque siamo nella situazione in cui il minimo non esiste nella classe 
$C^1_0$ ma esiste in una classe più ampia. 
Questo ci porta a pensare che per avere esistenza del minimo sia 
necessario considerare una classe più ampia di funzioni.
D'altra parte le cose possono anche andare peggio, 
come mostra l'esempio seguente.
</p>
<p class="problem" label="pb:2">
Minimizzare il funzionale:
$$
\F(u) = \int_{-1}^1 \Enclose{1-u'(x)^2}^2 + \Enclose{u(x)}^2\, dx
$$
tra tutte le funzioni $u\in C^1([-1,1])$.
</p>
<p>
Come nell'esempio precedente il funzionale non è mai negativo e quindi 
se si ottiene un valore nullo questo sarà il minimo assoluto.
D'altra parte visto che $\F(u)$ è la somma di due quantità positive 
se risulta nullo dovrà essere nullo $\int_{-1}^1 \Enclose{u(x)}^2\, dx$
ma questo può succedere solo se $u(x) = 0$ quasi ovunque.
Ma in tal caso se $u$ è derivabile (in qualche senso) dovrà essere $u'(x)=0$ 
e quindi il primo addendo del funzionale (che è quello considerato nel problema precedente)
dà un contributo pari a $1$.
</p>
<p>
Possiamo però costruire funzioni di classe $C^1$ (ma anche di classe $C^\infty$)
che rendono il valore $\F(u)$ arbitrariamente piccolo. 
Basterà considerare funzioni a denti di sega con derivata quasi sempre 
pari a $1$ o $-1$ e valore compreso tra $0$ ed $\epsilon$. 
</p>
<p>
Abbiamo quindi un esempio di un funzionale che non ha minimo 
neanche ampliando la classe delle funzioni considerate.
</p>
<h2>Convessità</h2>
<p>
I funzionali considerati nei due esempi precedenti 
sono della forma classica del calcolo delle variazioni 
con lagrangiane:
$$
    f_2(x,z,p) = (1-p^2)^2, \qquad 
    f_3(x,z,p) = (1-p^2)^2 + z^2.
$$
Il problema della brachistocrona invece aveva lagrangiana
$$
    f(x,p) = \frac{\sqrt{1+p^2}}{\sqrt x}.
$$
Il vantaggio fondamentale di quest'ultimo problema 
è che la lagrangiana non dipende da $z$ 
e risulta essere convessa 
rispetto alla variabile $p$ per ogni $x$ fissato
(cosa che non avviene per $f_2$ e $f_3$).
Vediamo come questa proprietà ci permette di dimostrare 
che la cicloide, essendo 
soluzione dell'equazione di Eulero-Lagrange, 
è effettivamente un minimo del funzionale.
</p>
<p>
Per verificare che $f$ è convessa rispetto a $p$ 
basta farne le derivate:
$$
\begin{aligned}
    f_p &= \frac{p}{\sqrt{1+p^2}\sqrt x}, \\
    f_{pp} &= \frac{1+p^2-p^2}{(1+p^2)^{3/2}\sqrt x}.
\end{aligned}
$$
</p>

<p>
Se $f(x,p)$ è convessa rispetto a $p$
per ogni $x$, allora per ogni $p_0$ 
il grafico di $f$ sta sopra la retta tangente
in tale punto:
$$
f(x,p) - f(x,p_0) \geq f_p(x,p_0)\cdot (p-p_0).
$$
Sia ora $u_0$ la soluzione dell'equazione di Eulero-Lagrange
(la cicloide nel nostro caso).
Per ogni $x$ possiamo scegliere $p_0=u_0'(x)$ per ottenere 
$$
f(x,u'(x)) - f(x,u_0'(x)) 
\geq f_p(x,u_0'(x))\cdot (u'(x)-u_0'(x))
$$
e integrando su $[0,a]$ si ottiene
$$
\F(u)-\F(u_0) = \int_0^a f_p(x,u_0,u_0')(u'-u_0')\, dx.
$$
Ma l'equazione di Eulero-Lagrange ci diceva che $f_p(x,u_0(x))$ 
è costante (in questo caso particolare, 
in quanto $f_z=0$) e dunque 
$$
\F(u)-\F(u_0) 
= c \int_0^a (u'-u_0')\, dx 
= c \Enclose{u-u_0}_0^a = 0
$$
in quanto $u(0)=u(a)=u_0(0)=u_0(a)=0$.
Abbiamo quindi dimostrato che $u_0$, la nostra cicloide, 
è un minimo assoluto nella classe di tutte le funzioni $C^1$ con condizione
al bordo fissate.
</p>

<p>
In astratto se $\F$ è un funzionale definito 
su uno spazio affine $X$ diremo che $\F$ 
è convesso se per ogni $u,v\in X$ 
e ogni $t\in (0,1)$ si ha:
\[
    \F((1-t)u + tv) \le (1-t)\F(u) + t\F(v).
\]
Diremo che $\F$ è <i>strettamente convesso</i>
se vale la disuguaglianza stretta.
</p>

<p>
Nel caso di un funzionale classico del calcolo delle 
variazioni si ha $X=\ENCLOSE{u\in C^1([a,b])\colon u(a)=u_a, 
    u(b)=u_b}$
e $\F(u) = \int_a^b f(x,u,u')\, dx$.
Se per ogni $x\in[a,b]$ la lagrangiana 
$f=f(x,z,p)$ è convessa nella coppia $(z,p)$
cioè se 
$f(x,(1-t)z+tw,(1-t)p+tq)
\le (1-t)f(x,z,p) + t f(x,w,q)$,
risulta che $\F$ è convesso. Infatti:
$$\begin{align*}
    \F((1-t)u + tv) 
    &= \int_a^b f(x,(1-t)u(x) + t v(x), 
        (1-t)u'(x) + t v'(x))\, dx
    \\
    &\le \int_a^b \Enclose {(1-t) f(x,u(x),u'(x)) 
        + t f(x,v(x),v'(x))}\, dx
    \\
    &= (1-t)\F(u) + t\F(v).
\end{align*}$$
</p>

<p>
Diremo che $u_0$ è <i>punto critico</i> di $\F$
se per ogni $v\in X$ vale
$$
  \Enclose {\frac{d}{d\eps} \F(u_0 + \eps (v-u_0))}_{\eps=0}
  = 0.
$$
</p>

<p class="theorem">
Se $\F$ è convesso e $u_0$ è punto critico di $\F$
allora $u_0$ è minimo assoluto di $\F$.
Se $\F$ è strettamente convesso $u_0$ è anche unico.
</p>
<p></p>

<h2>Estremali, estremali deboli</h2>
<p>
Diremo che $u$ è un <i>estremale debole</i>
per il funzionale $\F$ se 
per ogni variazione $\phi$ la derivata di $\F$ 
nella direzione $\phi$ è nulla:
\[
0 = \delta\F(u,\phi)
= \frac{\partial\F(u)}{\partial \phi} 
= \Enclose{\frac{d}{d\eps}\F(u+\eps\phi)}_{\eps=0}.
\]
Chiaramente se $\F$ ha minimo in $u$ 
allora $u$ è un estremale debole, come abbiamo già osservato.
Per avere un estremale debole è sufficiente la minimalità locale 
(ovvero per <i>piccole</i> variazioni). 
Ma questa non è una condizione necessaria. 
Come per le funzioni di una variabile è infatti possibile 
avere punti critici (estremali deboli) che non sono né punti 
di massimo né punti di minimo, neanche localmente.
L'esempio più semplice è $f(p)=p^3$ che ci fornisce 
anche l'esempio con i funzionali del calcolo delle variazioni.
</p>
<p class="problem" label="pb:3">
Minimizzare il funzionale:
\[
    \F(u) = \int_0^1 u'(x)^3\, dx
\]
sulla classe $C^1_0([0,1])$.
</p>
<p>
Osserviamo che la lagrangiana è $f(x,z,p) = p^3$ 
e l'equazione di Eulero Lagrange $(f_p)'=f_z$ 
diventa $3(u')^2 = m$ (costante) ovvero $u(x) = mx + q$. 
Ma dalle condizioni al bordo dovrà essere $m=0$ 
e $q=0$ quindi l'unica soluzione dell'equazione di E-L 
è $u(x)=0$.
D'altra parte con un po' di attenzione è possibile costruire 
funzioni $u_k$ tali che $\F(u_k)\to -\infty$ 
quando $\k\to +\infty$.
Bisogna osservare che una funzione con lo stesso valore agli 
estremi dell'intervallo deve avere una derivata con 
media nulla: $\int_0^1 u' = u(1) - u(0) = 0$.
Il termine $p^3$ dà un contributo negativo quando la derivata 
è negativa, ma non posso avere derivata negativa senza avere 
anche la corrispondente derivata positiva (la media è nulla).
<img src="problema3.png" alt="problema1" style="float: right; margin: 0 0 1em 1em;"/>
L'idea è però posso avere un tratto con pendenza negativa molto
ripido e compensarlo con un tratto a pendenza positiva ma meno 
ripido. Nel complesso il contributo dato dal tratto ripido, 
anche se più breve, sarà maggiore di quello dato dal tratto 
meno ripido, anche se più lungo. 
Lo si può fare con una funzione come quella nel disegno.   
Chiaramente la funzione può essere approssimata da funzioni 
$C^1$ (o anche $C^\infty$) senza modificare di molto 
il funzionale. 
</p>
<p class="theorem" name="condizione di Eulero-Lagrange">
Se $u$ è un estremale debole per il funzionale classico 
$\F$ con condizioni al bordo fissate, 
se $u\in C^2$ e anche $f\in C^2$ almeno in un intorno 
aperto della curva $(x,u(x),u'(x))$, allora vale 
l'equazione di Eulero-Lagrange:
\[
\frac{d}{dx} f_p = f_z.
\]
</p>
<p class="proof">
Già visto sopra. 
Si tratta eventualmente di verificare che bastano le ipotesi 
di regolarità appena enunciate.
</p>
<p>
Le $u$ che soddisfano l'equazione di E-L sono chiamate 
<i>estremali</i>. 
Dunque il teorema precedente afferma che estremali deboli 
sono estremali. 
\[
    \text{minimo} 
    \implies \text{minimo locale} 
    \implies \text{estremale debole}
    \Longleftarrow \text{estremale}.
\]
</p>

<p class="problem" name="equazione di Newton">
La lagrangiana $f(t,x,v) = \frac 1 2 m v^2 - V(x)$
ha come equazione di E-L:
\[
    - V_x = m x''
\]
che non è altro che l'equazione di Newton $F = ma$.
</p>

<h2>Calibrazioni, campi ottimali</h2>

<p>Se vogliamo dimostrare che $u_0$ è effettivamente 
un minimo del funzionale $\F$ dobbiamo mostrare 
che $\F(u)\ge \F(u_0)$ per ogni competitore $u$.
Supponiamo ora che la classe dei competitori abbia dato 
al bordo assegnato: $u(a)=u_a$ e $u(b)=u_b$.

In tal caso osserviamo che è possibile costruire 
delle <i>lagrangiane nulle</i>. 
Se prendiamo una funzione del tipo 
\[
    M(x,z,p) = S_x(x,z) + p \cdot S_p(x,z)
\]
si osserva che 
\[
M(x,u(x),u'(x)) = \frac{d}{dx} S(x,u(x))
\]
e dunque il funzionale
\[
\M(u) = \int_a^b M(x,u(x),u'(x))\, dx
=\Enclose{S(x,u(x))}_{x=a}^b
\]
è costante su ogni competitore.
Se dunque riusciamo a trovare 
$S$ e di conseguenza $M$ tali che 
$F(x,z,p) \ge M(x,z,p)$ 
e $F(x,u_0(x),u_0'(x)) = M(x,u_0(x),u_0'(x))$,
allora si avrà chiaramente 
\[
\F(u) \ge \M(u) = \M(u_0)
\]
e dunque sarà dimostrato che $u_0$ è un minimo 
del funzionale $\F$.

Un modo per costruire $S$ è quello
di ricavare $S$ da una fibrazione dello spazio $(x,z)$ 
tramite una famiglie di curve che contiene il grafico di $u_0$.

In generale consideriamo il grafico $z=u_0(x)$ ed un intorno $G$ 
di tale grafico nel piano $(x,z)$.
Supponiamo ora di avere una famiglia di funzioni 
$u_c(x)$ definite per $c$ in un intorno di $0$ 
in modo tale che per $c=0$ si abbia $u_c(x)=u_0(x)$ 
e che i grafici di $u_c(x)$ riempiano l'intorno $G$ 
senza mai intersecarsi tra loro.

Questo si ottiene tramite una funzione $f=f(x,c)$ che manda 
un rettangolo $\Gamma=[a,b]\times [-\eps,\eps]$ nell'intorno 
$G$ del grafico di $u_0$ in modo che sia $f(x,c) = (x, u_c(x))$
con $f\colon \Gamma\to G$ bigettiva.
Un tale campo si dice <i>campo adattato</i> ad $u_0$.

La fibrazione $f$ induce un campo di pendenze che denotiamo 
con $\P(x,z) = u_c'(x)$ dove $c=f^{-1}(x,z)$.
Diremo che il campo $\P$, adattato a $u_0$, 
è ottimale per il funzionale $\F$ in $u_0$ se 
esiste una funzione $S(x,z)$ tale che posto 
$M(x,z,p) = S_x(x,z) + p \cdot S_p(x,z)$ risulta 
\[
    F(x,z,p) \ge M(x,z,p)
    \qquad\text{e}\qquad
    F(x,u_0(x),u_0'(x)) = M(x,u_0(x),u_0'(x))
\]
per ogni $(x,z)\in G$ e per ogni $p\in \RR$.
Questo ovviamente implica che 
\[
   \F(u) \ge \M(u) = \M(u_0) = \F(u_0)
\]
per ogni $u$ con grafico dentro $G$ e quindi 
garantisce che $u_0$ è il minimo di $\F$ nell'intorno $G$.
Si noti che stiamo ottenendo un minimo locale in topologia 
$C^0$ e non in $C^1$.
Diremo che il campo $f$ è <i>ottimale</i> se 
è ottimale adattato ad ogni $u_c$ della fibrazione
cioè se $F(x,z,\P) = M(x,z,\P)$ su tutto $G$.

Per costruire $S$ dobbiamo identificarne delle proprietà. 
Cominciamo con la seguente osservazione.

</p>
<p class="lemma">
Se $F\ge M$ allora $S$ rende $f$ ottimale 
se e solo se 
$S$ soddisfa le <i>equazioni di Caratheodory:</i>    
\[
\begin{cases}
 S_x(x,z) = F(x, z,\P) - \P\cdot F_p(x,z,\P) \\
 S_z(x,z) = F_p(x,z,\P).
 \end{cases}
\]
</p>
<p class="proof">
Se $S$ soddisfa le equazioni di Caratheodory, si ha 
\[
F(x,z,\P) 
= S_x + \P \cdot F_p(x,z,\P)
= S_x + \P \cdot S_z = M(x,z,\P).
\]
Viceversa se $F(x,z,\P) = M(x,z,\P)$ 
e contemporaneamente $F(x,z,p)\ge M(x,z,p)$
per ogni $(x,z,p)\in G\times \RR^n$ allora
la funzione $F(x,z,p)-M(x,z,p)$ ha un 
minimo quando $p=\P(x,z)$
e dunque la sua derivata rispetto a $p$ 
(ovvero il gradiente se $p$ è un vettore)
è nulla quando $p=\P(x,z)$.
Significa che $F_p(x,z,\P) = M_p(x,z,\P)$.
Ma $M=S_x + pS_z$ dunque $M_p = S_z$ e si
ottiene la seconda equazione di Caratheodory.
Ma ora, visto che $F(x,z,\P) = M(x,z,\P)$
si deduce $F(x,z,\P) = S_x + \P S_z(x,z,\P)
= S_x + \P F_p(x,z,\P)$.
</p>
Sia dunque 
\[
\omega 
    = \enclose{F(x, z,\P) - \P\cdot F_p(x,z,\P)}\, dx 
    + F_p(x,z,\P)\, dz.
\]
Nello spazio $(x,z,p)$ definiamo la forma differenziale 
\[
\gamma
    = \enclose{F(x, z, p) - p \cdot F_p(x,z,p)}\, dx
    + F_p(x,z,p)\, dz
    = \enclose(F-pF_p)dx + F_p dz
\]
di cui $\omega$ è il pull-back tramite 
la funzione $\Phi(x,z) = (x,z,\P(x,z))$:
\[
  \Gamma_{xc} \stackrel{f}{\longrightarrow} 
  G_{xz} \stackrel{\Phi}{\longrightarrow}
  \RR^3_{xzp}.
\]
Vogliamo dimostrare che $\omega$ è chiusa 
cosicché se $G$ è semplicemente connesso 
possiamo dedurre che $\omega$ sia esatta, 
cioè che effettivamente esista $S$ 
tale che $dS = S_x dx + S_z dz = \omega$.

Vogliamo mostrare che $d f^*\omega = 0$.
Tramite la composizione $\Phi\circ f$ si ha
$z=u_c(x)$, $p=u_c'(x)$ e 
$dz = u'_c dx + \frac d{dc} u_c(x) dc$. 
Dunque si ha:
\[
  \begin{align*}
  f^* \omega 
    &= f^* \Phi^* \gamma\\
    &= \enclose{F(x,u_c,u'_c) - u'_c F_p(x,u_c,u'_c))} dx 
    + F_p(x,u_c,u'_c) \enclose{u'_c dx + \frac {du_c}{dc} \, dc}
    \\
    &= F(x,u_c,u'_c)dx + F_p(x,u_c,u'_c) \frac {du_c}{dc} u_c\, dc
  \end{align*}.
\]





</main></div>
        <!-- my code -->        
        <script src="index.js"></script>
        <!-- bootstrap-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
    </body>
</html>